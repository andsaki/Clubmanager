<div class = "calendar">
<% today = Date.today%>

  <table align="left">
    <caption>
      <%= link_to "#{today.strftime('%Y年%-m月')}", "/events/calender/0"%>
    </caption>
    
    <tr>
      <th width="30" height="20"><font color="red">日</font></th>
      <th width="30" height="20">月</th>
      <th width="30" height="20">火</th>
      <th width="30" height="20">水</th>
      <th width="30" height="20">木</th>
      <th width="30" height="20">金</th>
      <th width="30" height="20"><font color="blue">土</font></th>
    </tr>

    <% month = today.strftime('%m')%>
      <% d = today.at_beginning_of_month.at_beginning_of_week(:sunday)%>
        <% 1.upto(5).each do |i| %>
          <tr>
            <% (d..d.end_of_week(:sunday)).each do |c| %>
            <th width = "20" height = "20">
              <font size = "1">
                <!--<%= (c.strftime('%m') == month)? c.strftime('%d'): "  "%>-->
		<% @f = 0 %>
		<% if c.strftime('%m') == month then %>
                  <% @events.each do |e| %>
		    <% if ( (c.strftime('%Y') == e.year) && (c.strftime('%m') == e.month) && (c.strftime('%d') == e.date) ) then %>
		      <%= link_to "#{c.strftime('%-d')}", events_index_path(:year => c.strftime('%Y'), :month => c.strftime("%-m"), :day => c.strftime("%-d")) %>
		      <% @f = 1%>
                      <% break %>
                    <% else %>
                    <% end %>
		  <% end %>
		  <% if @f == 0 then %>
		  <%= c.strftime("%-d") %>
                  <% else %>
                  <% end %>
		<% else %>
		<% end %>
		<!-- -->
              </font>
            </th>
            <% end %>
          <% d = d + 1.week %>
          </tr>
        <% end %>
  </table>
  <p align="center"><%= link_to 'Add New Event', '/events/new' %></p>
</div>
